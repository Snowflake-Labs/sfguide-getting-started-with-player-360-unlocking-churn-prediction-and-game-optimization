USE ROLE SYSADMIN;
CREATE DATABASE PLAYER_360;
CREATE SCHEMA PLAYER_360.RAW;
CREATE SCHEMA PLAYER_360.ANALYTIC;
CREATE SCHEMA PLAYER_360.APP;
CREATE OR REPLACE WAREHOUSE PLAYER_360_DATA_APP_WH 
WITH 
    WAREHOUSE_TYPE = 'STANDARD', 
    WAREHOUSE_SIZE = 'MEDIUM', 
    AUTO_SUSPEND = 560 
    AUTO_RESUME = TRUE;

CREATE OR REPLACE WAREHOUSE PLAYER_360_BUILD_WH 
WITH 
    WAREHOUSE_TYPE = 'STANDARD', 
    WAREHOUSE_SIZE = '3X-Large', 
    AUTO_SUSPEND = 60, 
    AUTO_RESUME = TRUE;


USE DATABASE PLAYER_360;
USE SCHEMA ANALYTIC;
USE WAREHOUSE PLAYER_360_BUILD_WH;

CREATE STAGE IF NOT EXISTS {{ env.DATAOPS_DATABASE }}.app.streamlit_player360 DIRECTORY = (ENABLE = TRUE) ENCRYPTION = (TYPE = 'SNOWFLAKE_SSE');
GRANT OWNERSHIP ON STAGE {{ env.DATAOPS_DATABASE }}.app.streamlit_player360 TO ROLE public COPY CURRENT GRANTS;
CREATE STAGE IF NOT EXISTS PLAYER_360.analytic.notebook_static_churn_prediction DIRECTORY = (ENABLE = TRUE) ENCRYPTION = (TYPE = 'SNOWFLAKE_SSE');
GRANT OWNERSHIP ON STAGE PLAYER_360.analytic.notebook_static_churn_prediction TO ROLE public COPY CURRENT GRANTS;
CREATE STAGE IF NOT EXISTS PLAYER_360.analytic.notebook_rolling_churn_prediction DIRECTORY = (ENABLE = TRUE) ENCRYPTION = (TYPE = 'SNOWFLAKE_SSE')
GRANT OWNERSHIP ON STAGE PLAYER_360.analytic.notebook_rolling_churn_prediction TO ROLE public COPY CURRENT GRANTS;
CREATE STAGE IF NOT EXISTS PLAYER_360.raw.support
    URL = 's3://sfquickstarts/sfguide_getting_started_with_player_360_unlocking_churn_prediction_and_game_optimization/'
    ENCRYPTION = (TYPE = 'SNOWFLAKE_SSE');

GRANT OWNERSHIP ON STAGE PLAYER_360.raw.support TO ROLE public COPY CURRENT GRANTS;